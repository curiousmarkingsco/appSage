<!-- index.html -->
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="./css/main.css">
  <title>pageSage App Designer</title>
</head>

<body>
  <div class="flex">
    <div id="sidebar" class="w-72 bg-gray-200 fixed h-screen overflow-y-auto overscroll-contain pb-16">
      <!-- Sidebar content for editing elements will be dynamically added here -->
      <div id="sidebar-dynamic" class="p-4 mt-4">
        <p>No content to edit. Add content by making a grid or column.</p>
      </div>
    </div>
    <div id="page" class="min-h-screen w-[calc(100%-18rem)] ml-72">
      <!-- The user's page content goes here -->
    </div>
  </div>
  <div class="mt-20"><!-- Give the bottom some space for anything that might bleed under the Add Grid element --></div>
  <div class="w-[calc(100%-18rem)] ml-72 bg-[#efefef] block fixed bottom-0 text-center" id="gridButtonsBottombar">
    <button id="addGrid"
      class="pagebuilder-only mt-4 bg-blue-500 hover:bg-blue-700 text-white font-bold pt-1 pb-1.5 px-4 mb-2 rounded inline mx-auto">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" fill="white"
        class="h-4 w-4 inline"><!--!Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.-->
        <path
          d="M256 80c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 144L48 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l144 0 0 144c0 17.7 14.3 32 32 32s32-14.3 32-32l0-144 144 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-144 0 0-144z" />
      </svg>
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" fill="white"
        class=" h-5 w-5 inline"><!--!Font Awesome Pro 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2024 Fonticons, Inc.-->
        <path
          d="M0 72C0 49.9 17.9 32 40 32l48 0c22.1 0 40 17.9 40 40l0 48c0 22.1-17.9 40-40 40l-48 0c-22.1 0-40-17.9-40-40L0 72zM0 232c0-22.1 17.9-40 40-40l48 0c22.1 0 40 17.9 40 40l0 48c0 22.1-17.9 40-40 40l-48 0c-22.1 0-40-17.9-40-40l0-48zM128 392l0 48c0 22.1-17.9 40-40 40l-48 0c-22.1 0-40-17.9-40-40l0-48c0-22.1 17.9-40 40-40l48 0c22.1 0 40 17.9 40 40zM160 72c0-22.1 17.9-40 40-40l48 0c22.1 0 40 17.9 40 40l0 48c0 22.1-17.9 40-40 40l-48 0c-22.1 0-40-17.9-40-40l0-48zM288 232l0 48c0 22.1-17.9 40-40 40l-48 0c-22.1 0-40-17.9-40-40l0-48c0-22.1 17.9-40 40-40l48 0c22.1 0 40 17.9 40 40zM160 392c0-22.1 17.9-40 40-40l48 0c22.1 0 40 17.9 40 40l0 48c0 22.1-17.9 40-40 40l-48 0c-22.1 0-40-17.9-40-40l0-48zM448 72l0 48c0 22.1-17.9 40-40 40l-48 0c-22.1 0-40-17.9-40-40l0-48c0-22.1 17.9-40 40-40l48 0c22.1 0 40 17.9 40 40zM320 232c0-22.1 17.9-40 40-40l48 0c22.1 0 40 17.9 40 40l0 48c0 22.1-17.9 40-40 40l-48 0c-22.1 0-40-17.9-40-40l0-48zM448 392l0 48c0 22.1-17.9 40-40 40l-48 0c-22.1 0-40-17.9-40-40l0-48c0-22.1 17.9-40 40-40l48 0c22.1 0 40 17.9 40 40z" />
      </svg>
    </button>
    <button id="editPageSettings"
      class="pagebuilder-only mt-4 bg-green-500 hover:bg-green-700 text-white font-bold p-2 px-4 mb-2 rounded float-right mr-4">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512" fill="white"
        class="h-5 w-5 mx-auto"><!--!Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.-->
        <path
          d="M0 64C0 28.7 28.7 0 64 0L224 0l0 128c0 17.7 14.3 32 32 32l128 0 0 125.7-86.8 86.8c-10.3 10.3-17.5 23.1-21 37.2l-18.7 74.9c-2.3 9.2-1.8 18.8 1.3 27.5L64 512c-35.3 0-64-28.7-64-64L0 64zm384 64l-128 0L256 0 384 128zM549.8 235.7l14.4 14.4c15.6 15.6 15.6 40.9 0 56.6l-29.4 29.4-71-71 29.4-29.4c15.6-15.6 40.9-15.6 56.6 0zM311.9 417L441.1 287.8l71 71L382.9 487.9c-4.1 4.1-9.2 7-14.9 8.4l-60.1 15c-5.5 1.4-11.2-.2-15.2-4.2s-5.6-9.7-4.2-15.2l15-60.1c1.4-5.6 4.3-10.8 8.4-14.9z" />
      </svg>
    </button>
    <button id="copyPage" onclick="copyPageHTML(this)"
      class="pagebuilder-only transition mt-4 bg-green-500 hover:bg-green-700 text-white font-bold p-2 px-4 mb-2 rounded float-right mr-4">
      <svg xmlns="http://www.w3.org/2000/svg" fill="white" class="h-5 w-5 mx-auto"
        viewBox="0 0 448 512"><!--!Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.-->
        <path
          d="M208 0L332.1 0c12.7 0 24.9 5.1 33.9 14.1l67.9 67.9c9 9 14.1 21.2 14.1 33.9L448 336c0 26.5-21.5 48-48 48l-192 0c-26.5 0-48-21.5-48-48l0-288c0-26.5 21.5-48 48-48zM48 128l80 0 0 64-64 0 0 256 192 0 0-32 64 0 0 48c0 26.5-21.5 48-48 48L48 512c-26.5 0-48-21.5-48-48L0 176c0-26.5 21.5-48 48-48z" />
      </svg>
    </button>
  </div>

  <script src="./js/grid.js"></script>
  <script src="./js/column.js"></script>
  <script src="./js/content.js"></script>
  <script src="./js/sidebar.js"></script>
  <script src="./js/style.js"></script>
  <script src="./js/main.js"></script>
  <script src="./js/load.js"></script>
  <script src="./js/responsive.js"></script>
  <script src="./js/remote_save.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const params = new URLSearchParams(window.location.search);
      const config = params.get('config');
      if (config) {
        const json = loadPage(config);
        if (json) {
          loadChanges(json);
          loadPageSettings(config);
        }
        setupAutoSave(config);
      } else {
        let pageId = createNewConfigurationFile();
        setupAutoSave(pageId);
      }
    });

    function createNewConfigurationFile() {
      let filename = 'Untitled';
      let counter = 1;
      while (loadPage(filename)) {
        filename = `Untitled-${counter}`;
        counter++;
      }

      savePage(filename, '[]'); // Initialize with an empty array
      window.location.search = `?config=${filename}`; // Redirect with the new file as a parameter
      return filename;
    }
  </script>
</body>

</html>